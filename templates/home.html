<html>
    <body>
        <table width='100%' height='100%' border=1 align='center' valign='center' >
            <tr>
                <td colspan="10">
                    <div style="width: 100%">
                        <input type="button" style="color: green; float:left; height:50px;width:200px" value="Open Gate" 
                                        onclick="new Image().src='/gate?state=open'"/>
                        <input type="button" style="color: red; float:right; height:50px;width:200px" value="Close Gate"
                                        onclick="new Image().src='/gate?state=close'"/>
                    </div>

                </td>
            </tr>
            <tr>
                <th>
                    <h1>
                        Current View
                    </h1>
                </th>
                <th>
                    <h1>{{last_event}}</h1>
                </th>
                <th>
                    <h1>Recent Events</h1>
                </th>
            </tr>
            <tr>
                <td align='center' valign='center' id="current_frame_view"  >
                    <img src='motions/current_frame.png' id='current_frame0' 
                                    style="border: red solid 5px; display: block"/>
                    <img src='motions/current_frame.png' id='current_frame1' 
                                    style="border: red solid 5px; display: none"/>
                </td>
                <td align='center' valign='center' >
                    <table>
                        <tr>
                            <td>    
                                <img src='motions/event_current0.png' id='event_current' 
                                        style="border: green solid 5px"  />
                            
                            </td>
                            <td>{{event_images}}</td>                                
                        </tr>
                    </table>                
                </td>
                <td>
                    <div style="overflow-y: scroll; height:400px;">
                        {{recent_events}}
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan=10 width='100%'>
                    <iframe src="/last_event" width='100%' height='3000px' id='last_events'></iframe>
                </td>
            </tr>
        </table>
        
        <script language='javascript'>
            function update_current_view(){
                var url = 'motions/current_frame.png?t=' + new Date().getTime()
                
                var cf0 = document.getElementById("current_frame0")
                var cf1 = document.getElementById("current_frame1")

                var target_cf = cf0;
                var to_hide = cf1;

                if(cf0.style.display == "block"){
                    target_cf = cf1;
                    to_hide = cf0;
                }
                
                target_cf.src = url
                to_hide.style.display = "none"
                target_cf.style.display = "block"

                //document.getElementById("current_frame").src = url

            }

            setInterval(update_current_view, 1000);
            setInterval(function () {document.getElementById("event_current").src = 'motions/event_current.png?t=' + new Date().getTime();}, 1000);
            setInterval(function () {document.getElementById("last_events").contentWindow.location.reload()}, 5000);
        </script>
    </body>
</html>